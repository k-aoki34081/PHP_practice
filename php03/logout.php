<?php
// ===========================================
// ログアウト処理（logout.php）
// ===========================================
// このファイルはセッションを破棄して
// ログアウト処理を行います。
// ===========================================


// -----------------------------------------
// 1. セッション開始（最初に記述必須！）
// -----------------------------------------
session_start();


// -----------------------------------------
// 2. セッションの中身を全て削除
// -----------------------------------------
// $_SESSION を空の配列で上書きして初期化
// -----------------------------------------
$_SESSION = array();


// -----------------------------------------
// 3. Cookieに保存されているセッションIDを削除
// -----------------------------------------
// ブラウザに保存されているセッションCookieを
// 過去の日時に設定して無効化
// -----------------------------------------
if (isset($_COOKIE[session_name()])) {
    setcookie(
        session_name(),           // Cookie名（通常は PHPSESSID）
        '',                       // 空の値
        time() - 42000,           // 過去の時刻（有効期限切れ）
        '/'                       // パス
    );
}


// -----------------------------------------
// 4. サーバー側のセッションを破棄
// -----------------------------------------
// session_destroy() でサーバーに保存されている
// セッションファイルを削除
// -----------------------------------------
session_destroy();


// -----------------------------------------
// 5. ログインページにリダイレクト
// -----------------------------------------
header("Location: login.php");
exit();

