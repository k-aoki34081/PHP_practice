<?php
// ===========================================
// データ削除処理（delete.php）
// ===========================================
// このファイルは select.php からGETで
// IDを受け取り、該当データを削除します。
// ===========================================


// -----------------------------------------
// 1. GETパラメータからIDを取得
// -----------------------------------------
// URLの ?id=1 の部分を取得
// 例: delete.php?id=5 → $id = 5
// -----------------------------------------
$id = $_GET["id"];


// -----------------------------------------
// 2. 共通関数ファイルを読み込み、DB接続
// -----------------------------------------
include("funcs.php");
$pdo = db_conn();


// -----------------------------------------
// 3. DELETE文を作成・実行
// -----------------------------------------
// WHERE id = :id で削除対象を限定（超重要！）
// ※ WHERE を忘れると全データが削除される！
// ※ 削除したデータは復元できない！
// -----------------------------------------
$sql = "DELETE FROM gs_an_table WHERE id = :id";

$stmt = $pdo->prepare($sql);
$stmt->bindValue(':id', $id, PDO::PARAM_INT);

// SQLを実行
$status = $stmt->execute();


// -----------------------------------------
// 4. 実行結果の判定とリダイレクト
// -----------------------------------------
// 成功時: select.php にリダイレクト
// 失敗時: エラーメッセージを表示
// -----------------------------------------
if ($status == false) {
    // SQLエラーの場合
    sql_error($stmt);
} else {
    // 成功時は一覧画面に戻る
    redirect("select.php");
}

